<?php
namespace App\Services\Platforms\Netsuite\CustomFunctions;

use App\Models\DebugLogs;
use App\Models\IntegrationRecords;
use App\Libraries\Netsuite\NetsuiteHelpers\NetSuiteConstantHelper;

trait integration_3_custom_functions
{
    /**
     *  NOTE: If there is a need for a CUSTOM FUNCTION (functions that doesn't exist in the PLATFORM ABSTRACT CLASS) for the SOURCE INTEGRATION QUERY BUILDER, this function would create the query needed for
     *  building the parameters for integration source update parameters, the format of the function should be 'integration_sourceQueryBuilder' + '_' + INTEGRATION.ID column for example e.g
     *
     *  public function integration_sourceQueryBuilder_<INTEGRATION_ID>()
     *
     */

    /**
     * Custom Functions Example
     */
    // protected function integration_1_preGetTest() {
    //     Log::info('[CUSTOM_FUNCTIONS][PRE_GET_TEST] just testing!!');
    // }


    protected function integration_3_postGetTest()
    {
        // return json_decode("[{\"createdDate\":\"2020-02-17T13:58:41.000-08:00\",\"lastModifiedDate\":\"2020-02-17T14:00:24.000-08:00\",\"customForm\":null,\"postingPeriod\":null,\"entity\":{\"internalId\":\"3107\",\"externalId\":null,\"type\":null,\"name\":\"Chrome Engineering\"},\"createdFrom\":{\"internalId\":\"1424324\",\"externalId\":null,\"type\":null,\"name\":\"Sales Order #SO36480\"},\"requestedBy\":null,\"createdFromShipGroup\":null,\"partner\":null,\"shippingAddress\":{\"internalId\":\"23128\",\"country\":null,\"attention\":null,\"addressee\":\"Chrome Engineering\",\"addrPhone\":null,\"addr1\":\"62 Industrial Avenue\",\"addr2\":null,\"addr3\":null,\"city\":\"MARYBOROUGH\",\"state\":\"QLD\",\"zip\":\"4650\",\"addrText\":\"Chrome Engineering<br>62 Industrial Avenue<br>MARYBOROUGH QLD 4650\",\"override\":false,\"customFieldList\":null,\"nullFieldList\":null},\"pickedDate\":null,\"packedDate\":null,\"shippedDate\":null,\"shipIsResidential\":false,\"shipAddressList\":null,\"shipStatus\":null,\"saturdayDeliveryUps\":null,\"sendShipNotifyEmailUps\":null,\"sendBackupEmailUps\":null,\"shipNotifyEmailAddressUps\":null,\"shipNotifyEmailAddress2Ups\":null,\"backupEmailAddressUps\":null,\"shipNotifyEmailMessageUps\":null,\"thirdPartyAcctUps\":null,\"thirdPartyZipcodeUps\":null,\"thirdPartyCountryUps\":null,\"thirdPartyTypeUps\":null,\"partiesToTransactionUps\":null,\"exportTypeUps\":null,\"methodOfTransportUps\":null,\"carrierIdUps\":null,\"entryNumberUps\":null,\"inbondCodeUps\":null,\"isRoutedExportTransactionUps\":null,\"licenseNumberUps\":null,\"licenseDateUps\":null,\"licenseExceptionUps\":null,\"eccNumberUps\":null,\"recipientTaxIdUps\":null,\"blanketStartDateUps\":null,\"blanketEndDateUps\":null,\"shipmentWeightUps\":null,\"saturdayDeliveryFedEx\":null,\"saturdayPickupFedex\":null,\"sendShipNotifyEmailFedEx\":null,\"sendBackupEmailFedEx\":null,\"signatureHomeDeliveryFedEx\":null,\"shipNotifyEmailAddressFedEx\":null,\"backupEmailAddressFedEx\":null,\"shipDateFedEx\":null,\"homeDeliveryTypeFedEx\":null,\"homeDeliveryDateFedEx\":null,\"bookingConfirmationNumFedEx\":null,\"intlExemptionNumFedEx\":null,\"b13aFilingOptionFedEx\":null,\"b13aStatementDataFedEx\":null,\"thirdPartyAcctFedEx\":null,\"thirdPartyCountryFedEx\":null,\"thirdPartyTypeFedEx\":null,\"shipmentWeightFedEx\":null,\"termsOfSaleFedEx\":null,\"termsFreightChargeFedEx\":null,\"termsInsuranceChargeFedEx\":null,\"insideDeliveryFedEx\":null,\"insidePickupFedEx\":null,\"ancillaryEndorsementFedEx\":null,\"holdAtLocationFedEx\":null,\"halPhoneFedEx\":null,\"halAddr1FedEx\":null,\"halAddr2FedEx\":null,\"halAddr3FedEx\":null,\"halCityFedEx\":null,\"halZipFedEx\":null,\"halStateFedEx\":null,\"halCountryFedEx\":null,\"hazmatTypeFedEx\":null,\"accessibilityTypeFedEx\":null,\"isCargoAircraftOnlyFedEx\":null,\"tranDate\":\"2020-02-17T06:00:00.000-08:00\",\"tranId\":\"IF44453\",\"shipMethod\":{\"internalId\":\"34\",\"externalId\":null,\"type\":null,\"name\":\"Burnett Express\"},\"generateIntegratedShipperLabel\":null,\"shippingCost\":null,\"handlingCost\":null,\"memo\":null,\"transferLocation\":null,\"packageList\":{\"package\":[{\"packageWeight\":101.875,\"packageDescr\":null,\"packageTrackingNumber\":null}],\"replaceAll\":true},\"packageUpsList\":null,\"packageUspsList\":null,\"packageFedExList\":null,\"itemList\":{\"item\":[{\"jobName\":null,\"itemReceive\":true,\"itemName\":\"LCH-HC-20L\",\"description\":\"CT Citra Grit Hand Cleaner 20L\",\"department\":null,\"class\":null,\"location\":{\"internalId\":\"1\",\"externalId\":null,\"type\":null,\"name\":\"BUNDABERG\"},\"onHand\":0,\"quantity\":2,\"unitsDisplay\":\"DRM\",\"createPo\":null,\"inventoryDetail\":null,\"binNumbers\":null,\"serialNumbers\":null,\"poNum\":null,\"item\":{\"internalId\":\"9869\",\"externalId\":null,\"type\":null,\"name\":\"LCH-HC-20L\"},\"orderLine\":2,\"quantityRemaining\":null,\"options\":null,\"shipGroup\":null,\"itemIsFulfilled\":null,\"shipAddress\":null,\"shipMethod\":null,\"customFieldList\":{\"customField\":[{\"value\":\"LCH-HC-20L\",\"internalId\":\"1385\",\"scriptId\":\"custcol_item_code\"},{\"value\":\"https:\\\/\\\/system.netsuite.com\\\/core\\\/media\\\/media.nl?id=555557&c=3929178&h=5af27e554085c0503954\",\"internalId\":\"2383\",\"scriptId\":\"custcol_item_image_url\"}]}},{\"jobName\":null,\"itemReceive\":true,\"itemName\":\"LCH-HC-20L\",\"description\":\"CT Citra Grit Hand Cleaner 20L\",\"department\":null,\"class\":null,\"location\":{\"internalId\":\"1\",\"externalId\":null,\"type\":null,\"name\":\"BUNDABERG\"},\"onHand\":0,\"quantity\":2,\"unitsDisplay\":\"DRM\",\"createPo\":null,\"inventoryDetail\":null,\"binNumbers\":null,\"serialNumbers\":null,\"poNum\":null,\"item\":{\"internalId\":\"9869\",\"externalId\":null,\"type\":null,\"name\":\"LCH-HC-20L\"},\"orderLine\":2,\"quantityRemaining\":null,\"options\":null,\"shipGroup\":null,\"itemIsFulfilled\":null,\"shipAddress\":null,\"shipMethod\":null,\"customFieldList\":{\"customField\":[{\"value\":\"LCH-HC-20L\",\"internalId\":\"1385\",\"scriptId\":\"custcol_item_code\"},{\"value\":\"https:\\\/\\\/system.netsuite.com\\\/core\\\/media\\\/media.nl?id=555557&c=3929178&h=5af27e554085c0503954\",\"internalId\":\"2383\",\"scriptId\":\"custcol_item_image_url\"}]}},{\"jobName\":null,\"itemReceive\":true,\"itemName\":\"XTD-SDT4830\",\"description\":\"Duct Tape PVC 48mm x 30m Grey\",\"department\":null,\"class\":null,\"location\":{\"internalId\":\"1\",\"externalId\":null,\"type\":null,\"name\":\"BUNDABERG\"},\"onHand\":23,\"quantity\":36,\"unitsDisplay\":\"RL\",\"createPo\":null,\"inventoryDetail\":null,\"binNumbers\":null,\"serialNumbers\":null,\"poNum\":null,\"item\":{\"internalId\":\"7456\",\"externalId\":null,\"type\":null,\"name\":\"XTD-SDT4830\"},\"orderLine\":4,\"quantityRemaining\":null,\"options\":null,\"shipGroup\":null,\"itemIsFulfilled\":null,\"shipAddress\":null,\"shipMethod\":null,\"customFieldList\":{\"customField\":[{\"value\":\"XTD-SDT4830\",\"internalId\":\"1385\",\"scriptId\":\"custcol_item_code\"}]}},{\"jobName\":null,\"itemReceive\":true,\"itemName\":\"XPP-PTRT090\",\"description\":\"Paper Towel Rolls Tork 90m Roll 16rolls\\\/ctn\",\"department\":null,\"class\":null,\"location\":{\"internalId\":\"1\",\"externalId\":null,\"type\":null,\"name\":\"BUNDABERG\"},\"onHand\":288,\"quantity\":96,\"unitsDisplay\":\"RL\",\"createPo\":null,\"inventoryDetail\":null,\"binNumbers\":null,\"serialNumbers\":null,\"poNum\":null,\"item\":{\"internalId\":\"16488\",\"externalId\":null,\"type\":null,\"name\":\"XPP-PTRT090\"},\"orderLine\":5,\"quantityRemaining\":null,\"options\":null,\"shipGroup\":null,\"itemIsFulfilled\":null,\"shipAddress\":null,\"shipMethod\":null,\"customFieldList\":{\"customField\":[{\"value\":{\"name\":\"MachShip\",\"internalId\":13},\"internalId\":\"1385\",\"scriptId\":\"custcol19\"}]}}],\"replaceAll\":true},\"accountingBookDetailList\":null,\"customFieldList\":{\"customField\":[{\"value\":{\"name\":\"FIS [Always]\",\"internalId\":\"8\",\"externalId\":null,\"typeId\":\"199\"},\"internalId\":\"1551\",\"scriptId\":\"custbody12\"},{\"value\":\"37575\",\"internalId\":\"2323\",\"scriptId\":\"custbody25\"},{\"value\":\"BUNDABERG\",\"internalId\":\"2324\",\"scriptId\":\"custbody26\"},{\"value\":\"Leianda\",\"internalId\":\"2325\",\"scriptId\":\"custbody27\"},{\"value\":{\"name\":\"Net 30 EOM\",\"internalId\":\"7\",\"externalId\":null,\"typeId\":\"-199\"},\"internalId\":\"1417\",\"scriptId\":\"custbody3\"},{\"value\":false,\"internalId\":\"1822\",\"scriptId\":\"custbody_batch_numbers_recorded\"},{\"value\":88,\"internalId\":\"2471\",\"scriptId\":\"custbody_box_1_height\"},{\"value\":115,\"internalId\":\"2469\",\"scriptId\":\"custbody_box_1_length\"},{\"value\":1,\"internalId\":\"2468\",\"scriptId\":\"custbody_box_1_qty\"},{\"value\":{\"name\":\"Pallet\",\"internalId\":\"4\",\"externalId\":null,\"typeId\":\"359\"},\"internalId\":\"2473\",\"scriptId\":\"custbody_box_1_type\"},{\"value\":100,\"internalId\":\"2472\",\"scriptId\":\"custbody_box_1_weight\"},{\"value\":112,\"internalId\":\"2470\",\"scriptId\":\"custbody_box_1_width\"},{\"value\":false,\"internalId\":\"3207\",\"scriptId\":\"custbody_celigo_etail_order_fulfilled\"},{\"value\":false,\"internalId\":\"2462\",\"scriptId\":\"custbody_contains_dgs\"},{\"value\":\"rrwlhard@bigpond.net.au\",\"internalId\":\"2517\",\"scriptId\":\"custbody_despatch_notif_email\"},{\"value\":false,\"internalId\":\"2467\",\"scriptId\":\"custbody_do_not_send_machship\"},{\"value\":{\"name\":\"BUNDABERG\",\"internalId\":\"1\",\"externalId\":null,\"typeId\":\"-103\"},\"internalId\":\"2502\",\"scriptId\":\"custbody_ifl\"},{\"value\":false,\"internalId\":\"3237\",\"scriptId\":\"custbody_inv_wf_has_run\"},{\"value\":{\"name\":\"PROCESSING\",\"internalId\":\"2\",\"externalId\":null,\"typeId\":\"365\"},\"internalId\":\"2545\",\"scriptId\":\"custbody_machship_status\"},{\"value\":\"MS04086191\",\"internalId\":\"2565\",\"scriptId\":\"custbody_ms_tracking_number\"}]},\"internalId\":\"1431439\",\"externalId\":null,\"nullFieldList\":null}]", true);
        // $data = [$this->netsuite_object->findByTransaction('SOA0013118')];
        // $data = [$this->netsuite_object->findByTransaction('SOA0014415')];
        $data = json_decode("[{\"createdDate\":\"2020-02-20T14:10:19.000-08:00\",\"customForm\":null,\"entity\":{\"internalId\":\"62601\",\"externalId\":null,\"type\":null,\"name\":\"Displays 2 Go (in-house job)\"},\"job\":null,\"currency\":{\"internalId\":\"6\",\"externalId\":null,\"type\":null,\"name\":\"AUD\"},\"drAccount\":null,\"fxAccount\":null,\"tranDate\":\"2020-02-20T05:00:00.000-08:00\",\"tranId\":\"SOA0014415\",\"entityTaxRegNum\":null,\"source\":null,\"createdFrom\":null,\"orderStatus\":null,\"nextBill\":\"2020-02-20T05:00:00.000-08:00\",\"opportunity\":null,\"salesRep\":{\"internalId\":\"12220\",\"externalId\":null,\"type\":null,\"name\":\"House\"},\"contribPct\":null,\"partner\":null,\"salesGroup\":null,\"syncSalesTeams\":null,\"leadSource\":null,\"startDate\":null,\"endDate\":null,\"otherRefNum\":null,\"memo\":\"Testing\",\"salesEffectiveDate\":null,\"excludeCommission\":null,\"totalCostEstimate\":null,\"estGrossProfit\":null,\"estGrossProfitPercent\":null,\"exchangeRate\":1,\"promoCode\":null,\"currencyName\":\"AUD\",\"discountItem\":null,\"discountRate\":null,\"isTaxable\":null,\"taxItem\":null,\"taxRate\":null,\"toBePrinted\":null,\"toBeEmailed\":null,\"email\":null,\"toBeFaxed\":null,\"fax\":null,\"messageSel\":null,\"message\":null,\"paymentOption\":null,\"inputAuthCode\":null,\"inputReferenceCode\":null,\"checkNumber\":null,\"paymentCardCsc\":null,\"paymentProcessingProfile\":null,\"handlingMode\":null,\"outputAuthCode\":null,\"outputReferenceCode\":null,\"paymentOperation\":null,\"dynamicDescriptor\":null,\"billingAddress\":{\"internalId\":\"66536\",\"country\":\"_australia\",\"attention\":null,\"addressee\":\"Displays 2 Go (in-house job)\",\"addrPhone\":null,\"addr1\":null,\"addr2\":null,\"addr3\":null,\"city\":null,\"state\":null,\"zip\":null,\"addrText\":\"Displays 2 Go (in-house job)<br>Australia\",\"override\":false,\"customFieldList\":null,\"nullFieldList\":null},\"billAddressList\":null,\"shippingAddress\":null,\"shipIsResidential\":false,\"shipAddressList\":null,\"fob\":null,\"shipDate\":null,\"actualShipDate\":null,\"shipMethod\":null,\"shippingCost\":null,\"shippingTax1Rate\":null,\"isMultiShipTo\":true,\"shippingTax2Rate\":null,\"shippingTaxCode\":null,\"handlingTaxCode\":null,\"handlingTax1Rate\":null,\"handlingTax2Rate\":null,\"handlingCost\":null,\"trackingNumbers\":null,\"linkedTrackingNumbers\":null,\"shipComplete\":false,\"paymentMethod\":null,\"shopperIpAddress\":null,\"saveOnAuthDecline\":true,\"canHaveStackable\":false,\"creditCard\":null,\"revenueStatus\":null,\"recognizedRevenue\":null,\"deferredRevenue\":null,\"revRecOnRevCommitment\":null,\"revCommitStatus\":null,\"ccNumber\":null,\"ccExpireDate\":null,\"ccName\":null,\"ccStreet\":null,\"ccZipCode\":null,\"payPalStatus\":null,\"creditCardProcessor\":null,\"payPalTranId\":null,\"ccApproved\":null,\"getAuth\":null,\"authCode\":null,\"ccAvsStreetMatch\":null,\"ccAvsZipMatch\":null,\"isRecurringPayment\":null,\"ccSecurityCodeMatch\":null,\"altSalesTotal\":null,\"ignoreAvs\":null,\"paymentEventResult\":null,\"paymentEventHoldReason\":null,\"paymentEventType\":null,\"paymentEventDate\":null,\"paymentEventUpdatedBy\":null,\"subTotal\":0,\"discountTotal\":null,\"taxTotal\":0,\"altShippingCost\":null,\"altHandlingCost\":null,\"total\":0,\"revRecSchedule\":null,\"revRecStartDate\":null,\"revRecEndDate\":null,\"paypalAuthId\":null,\"balance\":0,\"paypalProcess\":null,\"billingSchedule\":null,\"ccSecurityCode\":null,\"threeDStatusCode\":null,\"class\":null,\"department\":null,\"subsidiary\":{\"internalId\":\"3\",\"externalId\":null,\"type\":null,\"name\":\"Displays 2 Go\"},\"intercoTransaction\":null,\"intercoStatus\":null,\"debitCardIssueNo\":null,\"lastModifiedDate\":\"2020-03-26T23:04:51.000-07:00\",\"nexus\":null,\"subsidiaryTaxRegNum\":null,\"taxRegOverride\":null,\"taxPointDate\":null,\"taxDetailsOverride\":null,\"location\":{\"internalId\":\"103\",\"externalId\":null,\"type\":null,\"name\":\"Sydney\"},\"pnRefNum\":null,\"status\":\"Pending Approval\",\"tax2Total\":null,\"terms\":{\"internalId\":\"18\",\"externalId\":null,\"type\":null,\"name\":\"Settlement Prior to Despatch\"},\"validFrom\":null,\"vatRegNum\":null,\"giftCertApplied\":null,\"oneTime\":null,\"recurWeekly\":null,\"recurMonthly\":null,\"recurQuarterly\":null,\"recurAnnually\":null,\"tranIsVsoeBundle\":null,\"vsoeAutoCalc\":null,\"syncPartnerTeams\":null,\"salesTeamList\":null,\"partnersList\":null,\"giftCertRedemptionList\":null,\"promotionsList\":null,\"itemList\":{\"item\":[{\"job\":null,\"subscription\":null,\"item\":{\"internalId\":\"11246\",\"externalId\":null,\"type\":null,\"name\":\"Custom - Installations\"},\"quantityAvailable\":null,\"expandItemGroup\":false,\"lineUniqueKey\":1126287,\"quantityOnHand\":null,\"quantity\":1,\"units\":null,\"inventoryDetail\":null,\"description\":null,\"price\":{\"internalId\":\"-1\",\"externalId\":null,\"type\":null,\"name\":\"Custom\"},\"rate\":null,\"serialNumbers\":null,\"amount\":0,\"isTaxable\":null,\"commitInventory\":null,\"orderPriority\":null,\"licenseCode\":null,\"options\":null,\"department\":null,\"class\":null,\"location\":{\"internalId\":\"103\",\"externalId\":null,\"type\":null,\"name\":\"Sydney\"},\"createPo\":null,\"createdPo\":null,\"altSalesAmt\":null,\"createWo\":false,\"poVendor\":null,\"poCurrency\":null,\"poRate\":null,\"revRecSchedule\":null,\"revRecStartDate\":null,\"revRecTermInMonths\":null,\"revRecEndDate\":null,\"deferRevRec\":null,\"isClosed\":false,\"itemFulfillmentChoice\":null,\"catchUpPeriod\":null,\"billingSchedule\":null,\"fromJob\":null,\"grossAmt\":0,\"taxAmount\":null,\"excludeFromRateRequest\":null,\"isEstimate\":null,\"inventoryLocation\":null,\"inventorySubsidiary\":null,\"line\":1,\"percentComplete\":null,\"costEstimateType\":null,\"costEstimate\":null,\"quantityBackOrdered\":null,\"quantityBilled\":0,\"quantityCommitted\":null,\"quantityFulfilled\":0,\"quantityPacked\":null,\"quantityPicked\":null,\"tax1Amt\":0,\"taxCode\":{\"internalId\":\"7653\",\"externalId\":null,\"type\":null,\"name\":\"GST_AU:Standard GST Sell\"},\"taxRate1\":10,\"taxRate2\":null,\"giftCertFrom\":null,\"giftCertRecipientName\":null,\"giftCertRecipientEmail\":null,\"giftCertMessage\":null,\"giftCertNumber\":null,\"shipGroup\":1,\"itemIsFulfilled\":false,\"shipAddress\":{\"internalId\":\"80282\",\"externalId\":null,\"type\":null,\"name\":\"Test Address (Custom)\"},\"shipMethod\":null,\"vsoeSopGroup\":null,\"vsoeIsEstimate\":null,\"vsoePrice\":null,\"vsoeAmount\":null,\"vsoeAllocation\":null,\"vsoeDeferral\":null,\"vsoePermitDiscount\":null,\"vsoeDelivered\":null,\"expectedShipDate\":null,\"noAutoAssignLocation\":null,\"locationAutoAssigned\":null,\"taxDetailsReference\":null,\"chargeType\":null,\"customFieldList\":{\"customField\":[{\"value\":\"Custom - Installations\",\"internalId\":\"3559\",\"scriptId\":\"custcol16\"},{\"value\":\"Custom - Installations\",\"internalId\":\"3561\",\"scriptId\":\"custcol18\"},{\"value\":0,\"internalId\":\"3630\",\"scriptId\":\"custcol20\"},{\"value\":{\"name\":\"Custom Build\",\"internalId\":\"6\",\"externalId\":null,\"typeId\":\"456\"},\"internalId\":\"3579\",\"scriptId\":\"custcol_production_method\"},{\"value\":0,\"internalId\":\"393\",\"scriptId\":\"custcol_statistical_value_base_curr\"},{\"value\":false,\"internalId\":\"811\",\"scriptId\":\"custcol_wrm_claimitem\"},{\"value\":false,\"internalId\":\"829\",\"scriptId\":\"custcol_wrm_reg_hid_registerflag\"},{\"value\":0,\"internalId\":\"3625\",\"scriptId\":\"custcold2g_recognisedsaleamount\"}]}},{\"job\":null,\"subscription\":null,\"item\":{\"internalId\":\"11245\",\"externalId\":null,\"type\":null,\"name\":\"Custom - Freight, Packaging and Logistics\"},\"quantityAvailable\":null,\"expandItemGroup\":false,\"lineUniqueKey\":1126288,\"quantityOnHand\":null,\"quantity\":1,\"units\":null,\"inventoryDetail\":null,\"description\":null,\"price\":{\"internalId\":\"-1\",\"externalId\":null,\"type\":null,\"name\":\"Custom\"},\"rate\":null,\"serialNumbers\":null,\"amount\":0,\"isTaxable\":null,\"commitInventory\":null,\"orderPriority\":null,\"licenseCode\":null,\"options\":null,\"department\":null,\"class\":null,\"location\":{\"internalId\":\"103\",\"externalId\":null,\"type\":null,\"name\":\"Sydney\"},\"createPo\":null,\"createdPo\":null,\"altSalesAmt\":null,\"createWo\":false,\"poVendor\":null,\"poCurrency\":null,\"poRate\":null,\"revRecSchedule\":null,\"revRecStartDate\":null,\"revRecTermInMonths\":null,\"revRecEndDate\":null,\"deferRevRec\":null,\"isClosed\":false,\"itemFulfillmentChoice\":null,\"catchUpPeriod\":null,\"billingSchedule\":null,\"fromJob\":null,\"grossAmt\":0,\"taxAmount\":null,\"excludeFromRateRequest\":null,\"isEstimate\":null,\"inventoryLocation\":null,\"inventorySubsidiary\":null,\"line\":2,\"percentComplete\":null,\"costEstimateType\":null,\"costEstimate\":null,\"quantityBackOrdered\":null,\"quantityBilled\":0,\"quantityCommitted\":null,\"quantityFulfilled\":0,\"quantityPacked\":null,\"quantityPicked\":null,\"tax1Amt\":0,\"taxCode\":{\"internalId\":\"7653\",\"externalId\":null,\"type\":null,\"name\":\"GST_AU:Standard GST Sell\"},\"taxRate1\":10,\"taxRate2\":null,\"giftCertFrom\":null,\"giftCertRecipientName\":null,\"giftCertRecipientEmail\":null,\"giftCertMessage\":null,\"giftCertNumber\":null,\"shipGroup\":2,\"itemIsFulfilled\":false,\"shipAddress\":{\"internalId\":\"80659\",\"externalId\":null,\"type\":null,\"name\":\"Test Address 2 (Custom)\"},\"shipMethod\":null,\"vsoeSopGroup\":null,\"vsoeIsEstimate\":null,\"vsoePrice\":null,\"vsoeAmount\":null,\"vsoeAllocation\":null,\"vsoeDeferral\":null,\"vsoePermitDiscount\":null,\"vsoeDelivered\":null,\"expectedShipDate\":null,\"noAutoAssignLocation\":null,\"locationAutoAssigned\":null,\"taxDetailsReference\":null,\"chargeType\":null,\"customFieldList\":{\"customField\":[{\"value\":\"Custom - Freight, Packaging and Logistics\",\"internalId\":\"3559\",\"scriptId\":\"custcol16\"},{\"value\":\"Custom - Freight, Packaging and Logistics\",\"internalId\":\"3561\",\"scriptId\":\"custcol18\"},{\"value\":{\"name\":\"MachShip\",\"internalId\":\"13\",\"externalId\":null,\"typeId\":\"459\"},\"internalId\":\"3619\",\"scriptId\":\"custcol19\"},{\"value\":0,\"internalId\":\"3630\",\"scriptId\":\"custcol20\"},{\"value\":{\"name\":\"Custom Build\",\"internalId\":\"6\",\"externalId\":null,\"typeId\":\"456\"},\"internalId\":\"3579\",\"scriptId\":\"custcol_production_method\"},{\"value\":0,\"internalId\":\"393\",\"scriptId\":\"custcol_statistical_value_base_curr\"},{\"value\":false,\"internalId\":\"811\",\"scriptId\":\"custcol_wrm_claimitem\"},{\"value\":false,\"internalId\":\"829\",\"scriptId\":\"custcol_wrm_reg_hid_registerflag\"},{\"value\":0,\"internalId\":\"3625\",\"scriptId\":\"custcold2g_recognisedsaleamount\"}]}},{\"job\":null,\"subscription\":null,\"item\":{\"internalId\":\"14888\",\"externalId\":null,\"type\":null,\"name\":\"Custom - Experential\"},\"quantityAvailable\":null,\"expandItemGroup\":false,\"lineUniqueKey\":1126289,\"quantityOnHand\":null,\"quantity\":1,\"units\":null,\"inventoryDetail\":null,\"description\":null,\"price\":{\"internalId\":\"-1\",\"externalId\":null,\"type\":null,\"name\":\"Custom\"},\"rate\":null,\"serialNumbers\":null,\"amount\":0,\"isTaxable\":null,\"commitInventory\":null,\"orderPriority\":null,\"licenseCode\":null,\"options\":null,\"department\":null,\"class\":null,\"location\":{\"internalId\":\"103\",\"externalId\":null,\"type\":null,\"name\":\"Sydney\"},\"createPo\":null,\"createdPo\":null,\"altSalesAmt\":null,\"createWo\":false,\"poVendor\":null,\"poCurrency\":null,\"poRate\":null,\"revRecSchedule\":null,\"revRecStartDate\":null,\"revRecTermInMonths\":null,\"revRecEndDate\":null,\"deferRevRec\":null,\"isClosed\":false,\"itemFulfillmentChoice\":null,\"catchUpPeriod\":null,\"billingSchedule\":null,\"fromJob\":null,\"grossAmt\":0,\"taxAmount\":null,\"excludeFromRateRequest\":null,\"isEstimate\":null,\"inventoryLocation\":null,\"inventorySubsidiary\":null,\"line\":3,\"percentComplete\":null,\"costEstimateType\":null,\"costEstimate\":null,\"quantityBackOrdered\":null,\"quantityBilled\":0,\"quantityCommitted\":null,\"quantityFulfilled\":0,\"quantityPacked\":null,\"quantityPicked\":null,\"tax1Amt\":0,\"taxCode\":{\"internalId\":\"7653\",\"externalId\":null,\"type\":null,\"name\":\"GST_AU:Standard GST Sell\"},\"taxRate1\":10,\"taxRate2\":null,\"giftCertFrom\":null,\"giftCertRecipientName\":null,\"giftCertRecipientEmail\":null,\"giftCertMessage\":null,\"giftCertNumber\":null,\"shipGroup\":2,\"itemIsFulfilled\":false,\"shipAddress\":{\"internalId\":\"79254\",\"externalId\":null,\"type\":null,\"name\":\"Test Address 2 (Custom)\"},\"shipMethod\":null,\"vsoeSopGroup\":null,\"vsoeIsEstimate\":null,\"vsoePrice\":null,\"vsoeAmount\":null,\"vsoeAllocation\":null,\"vsoeDeferral\":null,\"vsoePermitDiscount\":null,\"vsoeDelivered\":null,\"expectedShipDate\":null,\"noAutoAssignLocation\":null,\"locationAutoAssigned\":null,\"taxDetailsReference\":null,\"chargeType\":null,\"customFieldList\":{\"customField\":[{\"value\":\"Custom - Experential\",\"internalId\":\"3559\",\"scriptId\":\"custcol16\"},{\"value\":\"Custom - Experential\",\"internalId\":\"3561\",\"scriptId\":\"custcol18\"},{\"value\":{\"name\":\"MachShip\",\"internalId\":\"13\",\"externalId\":null,\"typeId\":\"459\"},\"internalId\":\"3619\",\"scriptId\":\"custcol19\"},{\"value\":0,\"internalId\":\"3630\",\"scriptId\":\"custcol20\"},{\"value\":{\"name\":\"Custom Build\",\"internalId\":\"6\",\"externalId\":null,\"typeId\":\"456\"},\"internalId\":\"3579\",\"scriptId\":\"custcol_production_method\"},{\"value\":0,\"internalId\":\"393\",\"scriptId\":\"custcol_statistical_value_base_curr\"},{\"value\":false,\"internalId\":\"811\",\"scriptId\":\"custcol_wrm_claimitem\"},{\"value\":false,\"internalId\":\"829\",\"scriptId\":\"custcol_wrm_reg_hid_registerflag\"},{\"value\":0,\"internalId\":\"3625\",\"scriptId\":\"custcold2g_recognisedsaleamount\"}]}},{\"job\":null,\"subscription\":null,\"item\":{\"internalId\":\"11247\",\"externalId\":null,\"type\":null,\"name\":\"Custom - Outdoor Display\"},\"quantityAvailable\":null,\"expandItemGroup\":false,\"lineUniqueKey\":1126290,\"quantityOnHand\":null,\"quantity\":1,\"units\":null,\"inventoryDetail\":null,\"description\":null,\"price\":{\"internalId\":\"-1\",\"externalId\":null,\"type\":null,\"name\":\"Custom\"},\"rate\":null,\"serialNumbers\":null,\"amount\":0,\"isTaxable\":null,\"commitInventory\":null,\"orderPriority\":null,\"licenseCode\":null,\"options\":null,\"department\":null,\"class\":null,\"location\":{\"internalId\":\"103\",\"externalId\":null,\"type\":null,\"name\":\"Sydney\"},\"createPo\":null,\"createdPo\":null,\"altSalesAmt\":null,\"createWo\":false,\"poVendor\":null,\"poCurrency\":null,\"poRate\":null,\"revRecSchedule\":null,\"revRecStartDate\":null,\"revRecTermInMonths\":null,\"revRecEndDate\":null,\"deferRevRec\":null,\"isClosed\":false,\"itemFulfillmentChoice\":null,\"catchUpPeriod\":null,\"billingSchedule\":null,\"fromJob\":null,\"grossAmt\":0,\"taxAmount\":null,\"excludeFromRateRequest\":null,\"isEstimate\":null,\"inventoryLocation\":null,\"inventorySubsidiary\":null,\"line\":4,\"percentComplete\":null,\"costEstimateType\":null,\"costEstimate\":null,\"quantityBackOrdered\":null,\"quantityBilled\":0,\"quantityCommitted\":null,\"quantityFulfilled\":0,\"quantityPacked\":null,\"quantityPicked\":null,\"tax1Amt\":0,\"taxCode\":{\"internalId\":\"7653\",\"externalId\":null,\"type\":null,\"name\":\"GST_AU:Standard GST Sell\"},\"taxRate1\":10,\"taxRate2\":null,\"giftCertFrom\":null,\"giftCertRecipientName\":null,\"giftCertRecipientEmail\":null,\"giftCertMessage\":null,\"giftCertNumber\":null,\"shipGroup\":3,\"itemIsFulfilled\":false,\"shipAddress\":{\"internalId\":\"80284\",\"externalId\":null,\"type\":null,\"name\":\"Test Address 3 (Custom)\"},\"shipMethod\":null,\"vsoeSopGroup\":null,\"vsoeIsEstimate\":null,\"vsoePrice\":null,\"vsoeAmount\":null,\"vsoeAllocation\":null,\"vsoeDeferral\":null,\"vsoePermitDiscount\":null,\"vsoeDelivered\":null,\"expectedShipDate\":null,\"noAutoAssignLocation\":null,\"locationAutoAssigned\":null,\"taxDetailsReference\":null,\"chargeType\":null,\"customFieldList\":{\"customField\":[{\"value\":\"Custom - Outdoor Display\",\"internalId\":\"3559\",\"scriptId\":\"custcol16\"},{\"value\":\"Custom - Outdoor Display\",\"internalId\":\"3561\",\"scriptId\":\"custcol18\"},{\"value\":{\"name\":\"MachShip\",\"internalId\":\"13\",\"externalId\":null,\"typeId\":\"459\"},\"internalId\":\"3619\",\"scriptId\":\"custcol19\"},{\"value\":0,\"internalId\":\"3630\",\"scriptId\":\"custcol20\"},{\"value\":{\"name\":\"Custom Build\",\"internalId\":\"6\",\"externalId\":null,\"typeId\":\"456\"},\"internalId\":\"3579\",\"scriptId\":\"custcol_production_method\"},{\"value\":0,\"internalId\":\"393\",\"scriptId\":\"custcol_statistical_value_base_curr\"},{\"value\":false,\"internalId\":\"811\",\"scriptId\":\"custcol_wrm_claimitem\"},{\"value\":false,\"internalId\":\"829\",\"scriptId\":\"custcol_wrm_reg_hid_registerflag\"},{\"value\":0,\"internalId\":\"3625\",\"scriptId\":\"custcold2g_recognisedsaleamount\"}]}},{\"job\":null,\"subscription\":null,\"item\":{\"internalId\":\"11248\",\"externalId\":null,\"type\":null,\"name\":\"Custom - Portable\"},\"quantityAvailable\":null,\"expandItemGroup\":false,\"lineUniqueKey\":1126291,\"quantityOnHand\":null,\"quantity\":1,\"units\":null,\"inventoryDetail\":null,\"description\":null,\"price\":{\"internalId\":\"-1\",\"externalId\":null,\"type\":null,\"name\":\"Custom\"},\"rate\":null,\"serialNumbers\":null,\"amount\":0,\"isTaxable\":null,\"commitInventory\":null,\"orderPriority\":null,\"licenseCode\":null,\"options\":null,\"department\":null,\"class\":null,\"location\":{\"internalId\":\"103\",\"externalId\":null,\"type\":null,\"name\":\"Sydney\"},\"createPo\":null,\"createdPo\":null,\"altSalesAmt\":null,\"createWo\":false,\"poVendor\":null,\"poCurrency\":null,\"poRate\":null,\"revRecSchedule\":null,\"revRecStartDate\":null,\"revRecTermInMonths\":null,\"revRecEndDate\":null,\"deferRevRec\":null,\"isClosed\":false,\"itemFulfillmentChoice\":null,\"catchUpPeriod\":null,\"billingSchedule\":null,\"fromJob\":null,\"grossAmt\":0,\"taxAmount\":null,\"excludeFromRateRequest\":null,\"isEstimate\":null,\"inventoryLocation\":null,\"inventorySubsidiary\":null,\"line\":5,\"percentComplete\":null,\"costEstimateType\":null,\"costEstimate\":null,\"quantityBackOrdered\":null,\"quantityBilled\":0,\"quantityCommitted\":null,\"quantityFulfilled\":0,\"quantityPacked\":null,\"quantityPicked\":null,\"tax1Amt\":0,\"taxCode\":{\"internalId\":\"7653\",\"externalId\":null,\"type\":null,\"name\":\"GST_AU:Standard GST Sell\"},\"taxRate1\":10,\"taxRate2\":null,\"giftCertFrom\":null,\"giftCertRecipientName\":null,\"giftCertRecipientEmail\":null,\"giftCertMessage\":null,\"giftCertNumber\":null,\"shipGroup\":2,\"itemIsFulfilled\":false,\"shipAddress\":{\"internalId\":\"80659\",\"externalId\":null,\"type\":null,\"name\":\"Test Address 2 (Custom)\"},\"shipMethod\":null,\"vsoeSopGroup\":null,\"vsoeIsEstimate\":null,\"vsoePrice\":null,\"vsoeAmount\":null,\"vsoeAllocation\":null,\"vsoeDeferral\":null,\"vsoePermitDiscount\":null,\"vsoeDelivered\":null,\"expectedShipDate\":null,\"noAutoAssignLocation\":null,\"locationAutoAssigned\":null,\"taxDetailsReference\":null,\"chargeType\":null,\"customFieldList\":{\"customField\":[{\"value\":\"Custom - Portable\",\"internalId\":\"3559\",\"scriptId\":\"custcol16\"},{\"value\":\"Custom - Portable\",\"internalId\":\"3561\",\"scriptId\":\"custcol18\"},{\"value\":{\"name\":\"DHL - Road Freight\",\"internalId\":\"5\",\"externalId\":null,\"typeId\":\"459\"},\"internalId\":\"3619\",\"scriptId\":\"custcol19\"},{\"value\":0,\"internalId\":\"3630\",\"scriptId\":\"custcol20\"},{\"value\":{\"name\":\"Custom Build\",\"internalId\":\"6\",\"externalId\":null,\"typeId\":\"456\"},\"internalId\":\"3579\",\"scriptId\":\"custcol_production_method\"},{\"value\":0,\"internalId\":\"393\",\"scriptId\":\"custcol_statistical_value_base_curr\"},{\"value\":false,\"internalId\":\"811\",\"scriptId\":\"custcol_wrm_claimitem\"},{\"value\":false,\"internalId\":\"829\",\"scriptId\":\"custcol_wrm_reg_hid_registerflag\"},{\"value\":0,\"internalId\":\"3625\",\"scriptId\":\"custcold2g_recognisedsaleamount\"}]}},{\"job\":null,\"subscription\":null,\"item\":{\"internalId\":\"14887\",\"externalId\":null,\"type\":null,\"name\":\"Custom - Sampling and Demonstrating\"},\"quantityAvailable\":null,\"expandItemGroup\":false,\"lineUniqueKey\":1126292,\"quantityOnHand\":null,\"quantity\":1,\"units\":null,\"inventoryDetail\":null,\"description\":null,\"price\":{\"internalId\":\"-1\",\"externalId\":null,\"type\":null,\"name\":\"Custom\"},\"rate\":null,\"serialNumbers\":null,\"amount\":0,\"isTaxable\":null,\"commitInventory\":null,\"orderPriority\":null,\"licenseCode\":null,\"options\":null,\"department\":null,\"class\":null,\"location\":{\"internalId\":\"103\",\"externalId\":null,\"type\":null,\"name\":\"Sydney\"},\"createPo\":null,\"createdPo\":null,\"altSalesAmt\":null,\"createWo\":false,\"poVendor\":null,\"poCurrency\":null,\"poRate\":null,\"revRecSchedule\":null,\"revRecStartDate\":null,\"revRecTermInMonths\":null,\"revRecEndDate\":null,\"deferRevRec\":null,\"isClosed\":false,\"itemFulfillmentChoice\":null,\"catchUpPeriod\":null,\"billingSchedule\":null,\"fromJob\":null,\"grossAmt\":0,\"taxAmount\":null,\"excludeFromRateRequest\":null,\"isEstimate\":null,\"inventoryLocation\":null,\"inventorySubsidiary\":null,\"line\":6,\"percentComplete\":null,\"costEstimateType\":null,\"costEstimate\":null,\"quantityBackOrdered\":null,\"quantityBilled\":0,\"quantityCommitted\":null,\"quantityFulfilled\":0,\"quantityPacked\":null,\"quantityPicked\":null,\"tax1Amt\":0,\"taxCode\":{\"internalId\":\"7653\",\"externalId\":null,\"type\":null,\"name\":\"GST_AU:Standard GST Sell\"},\"taxRate1\":10,\"taxRate2\":null,\"giftCertFrom\":null,\"giftCertRecipientName\":null,\"giftCertRecipientEmail\":null,\"giftCertMessage\":null,\"giftCertNumber\":null,\"shipGroup\":4,\"itemIsFulfilled\":false,\"shipAddress\":{\"internalId\":\"79102\",\"externalId\":null,\"type\":null,\"name\":null},\"shipMethod\":null,\"vsoeSopGroup\":null,\"vsoeIsEstimate\":null,\"vsoePrice\":null,\"vsoeAmount\":null,\"vsoeAllocation\":null,\"vsoeDeferral\":null,\"vsoePermitDiscount\":null,\"vsoeDelivered\":null,\"expectedShipDate\":null,\"noAutoAssignLocation\":null,\"locationAutoAssigned\":null,\"taxDetailsReference\":null,\"chargeType\":null,\"customFieldList\":{\"customField\":[{\"value\":\"Custom - Sampling and Demonstrating\",\"internalId\":\"3559\",\"scriptId\":\"custcol16\"},{\"value\":\"Custom - Sampling and Demonstrating\",\"internalId\":\"3561\",\"scriptId\":\"custcol18\"},{\"value\":0,\"internalId\":\"3630\",\"scriptId\":\"custcol20\"},{\"value\":{\"name\":\"Custom Build\",\"internalId\":\"6\",\"externalId\":null,\"typeId\":\"456\"},\"internalId\":\"3579\",\"scriptId\":\"custcol_production_method\"},{\"value\":0,\"internalId\":\"393\",\"scriptId\":\"custcol_statistical_value_base_curr\"},{\"value\":false,\"internalId\":\"811\",\"scriptId\":\"custcol_wrm_claimitem\"},{\"value\":false,\"internalId\":\"829\",\"scriptId\":\"custcol_wrm_reg_hid_registerflag\"},{\"value\":0,\"internalId\":\"3625\",\"scriptId\":\"custcold2g_recognisedsaleamount\"}]}}],\"replaceAll\":true},\"shipGroupList\":{\"shipGroup\":[{\"id\":1,\"isFulfilled\":false,\"weight\":10,\"sourceAddressRef\":{\"internalId\":\"103\",\"externalId\":null,\"type\":null,\"name\":null},\"sourceAddress\":\"60-62 Sawyer Lane Artarmon Sydney, NSW 2064 AU\",\"destinationAddressRef\":{\"internalId\":\"80282\",\"externalId\":null,\"type\":null,\"name\":null},\"destinationAddress\":\"Here There Sydney Australia\",\"shippingMethodRef\":null,\"shippingMethod\":null,\"isHandlingTaxable\":null,\"handlingTaxCode\":null,\"handlingTaxRate\":null,\"handlingTax2Rate\":null,\"handlingRate\":0,\"handlingTaxAmt\":null,\"handlingTax2Amt\":null,\"isShippingTaxable\":null,\"shippingTaxCode\":{\"internalId\":\"7653\",\"externalId\":null,\"type\":null,\"name\":\"GST_AU:Standard GST Sell\"},\"shippingTaxRate\":null,\"shippingTax2Rate\":null,\"shippingRate\":0,\"shippingTaxAmt\":0,\"shippingTax2Amt\":null},{\"id\":2,\"isFulfilled\":false,\"weight\":30,\"sourceAddressRef\":{\"internalId\":\"103\",\"externalId\":null,\"type\":null,\"name\":null},\"sourceAddress\":\"60-62 Sawyer Lane Artarmon Sydney, NSW 2064 AU\",\"destinationAddressRef\":{\"internalId\":\"80659\",\"externalId\":null,\"type\":null,\"name\":null},\"destinationAddress\":\"Anywhere Somewhere Australia\",\"shippingMethodRef\":null,\"shippingMethod\":null,\"isHandlingTaxable\":null,\"handlingTaxCode\":null,\"handlingTaxRate\":null,\"handlingTax2Rate\":null,\"handlingRate\":0,\"handlingTaxAmt\":null,\"handlingTax2Amt\":null,\"isShippingTaxable\":null,\"shippingTaxCode\":{\"internalId\":\"7653\",\"externalId\":null,\"type\":null,\"name\":\"GST_AU:Standard GST Sell\"},\"shippingTaxRate\":null,\"shippingTax2Rate\":null,\"shippingRate\":0,\"shippingTaxAmt\":0,\"shippingTax2Amt\":null},{\"id\":3,\"isFulfilled\":false,\"weight\":10,\"sourceAddressRef\":{\"internalId\":\"103\",\"externalId\":null,\"type\":null,\"name\":null},\"sourceAddress\":\"60-62 Sawyer Lane Artarmon Sydney, NSW 2064 AU\",\"destinationAddressRef\":{\"internalId\":\"80284\",\"externalId\":null,\"type\":null,\"name\":null},\"destinationAddress\":\"Australia\",\"shippingMethodRef\":null,\"shippingMethod\":null,\"isHandlingTaxable\":null,\"handlingTaxCode\":null,\"handlingTaxRate\":null,\"handlingTax2Rate\":null,\"handlingRate\":0,\"handlingTaxAmt\":null,\"handlingTax2Amt\":null,\"isShippingTaxable\":null,\"shippingTaxCode\":{\"internalId\":\"7653\",\"externalId\":null,\"type\":null,\"name\":\"GST_AU:Standard GST Sell\"},\"shippingTaxRate\":null,\"shippingTax2Rate\":null,\"shippingRate\":0,\"shippingTaxAmt\":0,\"shippingTax2Amt\":null},{\"id\":4,\"isFulfilled\":false,\"weight\":10,\"sourceAddressRef\":{\"internalId\":\"103\",\"externalId\":null,\"type\":null,\"name\":null},\"sourceAddress\":\"60-62 Sawyer Lane Artarmon Sydney, NSW 2064 AU\",\"destinationAddressRef\":{\"internalId\":\"79102\",\"externalId\":null,\"type\":null,\"name\":null},\"destinationAddress\":\"Australia\",\"shippingMethodRef\":null,\"shippingMethod\":null,\"isHandlingTaxable\":null,\"handlingTaxCode\":null,\"handlingTaxRate\":null,\"handlingTax2Rate\":null,\"handlingRate\":0,\"handlingTaxAmt\":null,\"handlingTax2Amt\":null,\"isShippingTaxable\":null,\"shippingTaxCode\":{\"internalId\":\"7653\",\"externalId\":null,\"type\":null,\"name\":\"GST_AU:Standard GST Sell\"},\"shippingTaxRate\":null,\"shippingTax2Rate\":null,\"shippingRate\":0,\"shippingTaxAmt\":0,\"shippingTax2Amt\":null}],\"replaceAll\":true},\"accountingBookDetailList\":null,\"taxDetailsList\":null,\"customFieldList\":{\"customField\":[{\"value\":\"2020-02-27T05:00:00.000-08:00\",\"internalId\":\"2832\",\"scriptId\":\"custbody1\"},{\"value\":\"Displays 2 Go (in-house job)\",\"internalId\":\"3087\",\"scriptId\":\"custbody23\"},{\"value\":0,\"internalId\":\"3088\",\"scriptId\":\"custbody24\"},{\"value\":0,\"internalId\":\"3218\",\"scriptId\":\"custbody33\"},{\"value\":\"ERROR: Field 'totalamount' Not Found\",\"internalId\":\"3220\",\"scriptId\":\"custbody34\"},{\"value\":0,\"internalId\":\"3221\",\"scriptId\":\"custbody35\"},{\"value\":\"Test for MachShip\",\"internalId\":\"3014\",\"scriptId\":\"custbody4\"},{\"value\":{\"name\":\"Phil Hine\",\"internalId\":\"53206\",\"externalId\":null,\"typeId\":\"-4\"},\"internalId\":\"3306\",\"scriptId\":\"custbody42\"},{\"value\":\"FRIDAY    - 28 Feb 2020\",\"internalId\":\"3466\",\"scriptId\":\"custbody43\"},{\"value\":false,\"internalId\":\"3469\",\"scriptId\":\"custbody45\"},{\"value\":false,\"internalId\":\"3473\",\"scriptId\":\"custbody48\"},{\"value\":\"Good to Go\",\"internalId\":\"3489\",\"scriptId\":\"custbody49\"},{\"value\":\"QTOA0014415\",\"internalId\":\"3569\",\"scriptId\":\"custbody51\"},{\"value\":\"QTo Be Generated\",\"internalId\":\"3570\",\"scriptId\":\"custbody52\"},{\"value\":{\"name\":\"MachShip\",\"internalId\":\"13\",\"externalId\":null,\"typeId\":\"459\"},\"internalId\":\"3589\",\"scriptId\":\"custbody53\"},{\"value\":0,\"internalId\":\"3614\",\"scriptId\":\"custbody54\"},{\"value\":\"Good to Go\",\"internalId\":\"3615\",\"scriptId\":\"custbody55\"},{\"value\":true,\"internalId\":\"3618\",\"scriptId\":\"custbody58\"},{\"value\":\"Multi Ship\",\"internalId\":\"3622\",\"scriptId\":\"custbody59\"},{\"value\":\"2020-02-19T05:00:00.000-08:00\",\"internalId\":\"101\",\"scriptId\":\"custbody_esc_created_date\"},{\"value\":\"2020-03-25T06:00:00.000-07:00\",\"internalId\":\"102\",\"scriptId\":\"custbody_esc_last_modified_date\"},{\"value\":\"20\/2\/2020 14:6:42\",\"internalId\":\"408\",\"scriptId\":\"custbody_report_timestamp\"},{\"value\":false,\"internalId\":\"2589\",\"scriptId\":\"custbody_sii_article_61d\"},{\"value\":false,\"internalId\":\"2587\",\"scriptId\":\"custbody_sii_article_72_73\"},{\"value\":false,\"internalId\":\"553\",\"scriptId\":\"custbody_sii_is_third_party\"},{\"value\":false,\"internalId\":\"2588\",\"scriptId\":\"custbody_sii_not_reported_in_time\"},{\"value\":false,\"internalId\":\"814\",\"scriptId\":\"custbody_wrm_reg_hid_updateexpire\"},{\"value\":0,\"internalId\":\"3626\",\"scriptId\":\"custbodyd2g_salesorder_recfigures\"},{\"value\":0,\"internalId\":\"3627\",\"scriptId\":\"custbodyd2g_salesorder_recfiguresstat\"},{\"value\":0,\"internalId\":\"3598\",\"scriptId\":\"custbodyd2g_so_balance_dynamic\"}]},\"internalId\":\"80328\",\"externalId\":null,\"nullFieldList\":null}]");
        // $this->infoLog("[postGetTest]", $data);
        return $data;
    }


    /**
     * Create a custom function for integration d2g after get source
     * validate each item here and write a debug log for each skipped items
     * Original Function : getItems
     * Function Flow :
     * 1. Validate if an items is available
     * 2. iterate items
     * 3. Skip when check customfield script id is not 'custcol19'
     * 4. Skip when custcol19 value name isn't Machship or internalId isn't 13
     * 5. dedup shipAddress, skipped when existed for process
     * 6. then insert to new_items and will be return
     * @param array source_data         netsuite's raw data
     * @return array list of items
     */
    protected function integration_3_postGetItems(array $source_data)
    {

        // make sure items is available
        if (empty($this->items)) {
            $this->infoLog('[postGetItems]', 'is not available yet.');
            return [];
        }

        // items that will be sent back to process
        $new_items = [];
        $shipped = [];

        foreach ($this->items as $so_item) {
            // check if the custom field 19 is set from the custom fields
            if (in_array('customFieldList', $so_item)) {
                $custom_fields = $so_item['customFieldList']['customField'];
                $custom_field_coll = collect($custom_fields);
                if ($custom_field_coll->contains('scriptId', 'custcol19') == false) {
                    // we need to add this to debug log
                    $this->writeDebugLog(
                        DebugLogs::STEP_WF_3,
                        'SKIPPED',
                        'Pending consignment skipped (no custom field 19) for sales order ID: ' . $this->data['tranId'] . ' item: ' . json_encode($so_item['item'])
                    );
                    // skip
                    continue;
                } else {
                    $custom_field = $custom_field_coll->firstWhere('scriptId', 'custcol19');
                    $custom_field_value = $custom_field['value'];
                    if ($custom_field_value['name'] != 'MachShip' || $custom_field_value['internalId'] != 13) {
                        // we need to add this to debug log
                        $this->writeDebugLog(
                            DebugLogs::STEP_WF_3,
                            'SKIPPED',
                            'Pending consignment skipped custom field 19 NOT MACHSHIP for sales order ID: ' . $this->data['tranId'] . ' item: ' . json_encode($so_item['item'])
                        );
                        // skip
                        continue;
                    }
                }
            }

            if (in_array('shipAddress', $so_item)) {
                $ship_address = $so_item['shipAddress'];

                // if the ship address already exists, no need to create a consignment
                if (in_array($ship_address['internalId'], $shipped)) {
                    $this->writeDebugLog(
                        DebugLogs::STEP_WF_3,
                        'SKIPPED',
                        'Shipping address duplicate, pending consignment skipped for sales order ID: ' . $this->data['tranId'] . ' item: ' . json_encode($so_item['item'])
                    );
                    continue;
                }

                // TODO store sales order id, internal_id, external_id, name
                $shipped[] = $ship_address['internalId'];

                $new_items[] = $so_item;
            }
        }

        return $new_items;
    }

    /**
     * This custom function will prepare a pending consignment before return a record status
     * Original Function : getIntegrationRecordStatus
     * Function flow :
     * 1. Will get machship payload
     * 2. If the machship's items is empty, skipped write debug log
     * 3. Get customer data via raw data entity's internalId
     * 4. Iterate items from payload
     * 5. Gets address list from customer data
     * 6. Debug log as error if customer data is null or customer address book not found
     * 7. Populate new payload
     * 8. Insert new record for each items in payload
     * 9. When everythings clear, return skipped status
     * @return     string  status of integration record status
     */
    protected function integration_3_postGetIntegrationRecordStatus()
    {
        // now we need to create each items to record for D2G
        $payload = collect($this->machship_payload);
        if (empty($payload['items'])) {
            // no items to send to machship
            $this->writeDebugLog(DebugLogs::STEP_WF_3, 'SKIPPED', 'No items in machship payload');
            return IntegrationRecords::RECORD_STATUS_SKIPPED;
        }

        // get the customer data
        $so_id = $this->data['entity']['internalId'];
        $custom_object = $this->getNetsuiteObjectType(NetSuiteConstantHelper::NETSUITE_CUSTOMER);
        $netsuite_customer_object = $this->netsuite->setObject($custom_object);
        $netsuite_customer = $netsuite_customer_object->find($so_id);


        $items = $payload->pull('items');

        foreach ($items as $item) {
            $ship_address = $item['shipAddress'];
            $new_payload = $payload;

            $address = null;

            // this is necessary to fetch correct address
            if ($netsuite_customer) {
                $address_list = collect($netsuite_customer->addressbookList->addressbook);
                $customer_address_book = $address_list->where('internalId', $ship_address['internalId'])->first();
                if (empty($customer_address_book)) {
                    $this->writeDebugLog(DebugLogs::STEP_WF_3, 'ERROR', 'No customer address book found : ' . json_encode($ship_address) . ', From address list : ' . json_encode($address_list));
                    continue;
                }
                $address = json_decode(json_encode($customer_address_book->addressbookAddress), true);
            } else {
                $this->writeDebugLog(DebugLogs::STEP_WF_3, 'ERROR', 'No netsuite customer found');
                continue;
            }

            // addressee, address line 1, address line 2
            $new_payload['toName'] = $address['addressee'];
            $new_payload['toAddressLine1'] = $address['addr1'];
            $new_payload['toAddressLine2'] = $address['addr2'];

            // to location
            $to_location = array(
                'suburb' => $address['city'],
                'postcode' => $address['zip']
            );
            $new_payload['toLocation'] = $to_location;

            $record = [
                "integration_id"      => $this->integration->id,
                "integration_sync_id" => $this->integration_sync->id,
                "source_id"           => $this->data['internalId'],
                "source_data"         => $this->data,
                "record_status"       => IntegrationRecords::RECORD_STATUS_PENDING_MACHSHIP,
                "consignment_type"    => IntegrationRecords::RECORD_CONSIGNMENT_TYPE_PENDING,
                "process_after"       => $this->getIntegrationRecordProcessAfter(),
                "machship_payload"    => $new_payload
            ];
            IntegrationRecords::create($record);
        }

        // we return skipped here since the main record does not need to send to machship in D2G
        return IntegrationRecords::RECORD_STATUS_SKIPPED;
    }
}
